$(document).ready(function(){function a(a){var t=a,e=t.substr(0,4),s=t.substr(5,2),r=t.substr(8,2);return(a=new Date(e,s,r)).getDate()+" "+["Januari","Februari","Maret","April","Meil","Juni","Juli","Agustus","September","Oktober","November","Desember"][a.getMonth()-1]+" "+a.getFullYear()}function t(a,t,e){""!==a?($(t).html(a),$(t).addClass("bg-danger text-white mt-1 p-1 font-weight-bold"),$(t).css("border-radius","6px"),$(e).css("border","3px solid #e74a3b")):($(e).css("border","3px solid #1cc88a"),$(t).html(""),$(t).removeClass(),$(t).removeAttr("style"),$(t).removeAttr("class"))}function e(a){a.target.style.border="",a.target.parentElement.lastElementChild.className="",a.target.parentElement.lastElementChild.innerHTML=""}function s(a){a.target.offsetParent.style.border="",a.target.offsetParent.nextElementSibling.innerHTML="",a.target.offsetParent.nextElementSibling.className=""}function r(a){var t=a.toString().replace(/[^\d]/g,""),e=t.length%3,s=t.substr(0,e),r=t.substr(e).match(/\d{3}/g);if(r){if(e)var l=".";else l="";var i=s+l+r.join(".")}return i}function l(a,t,e){$(a).val(""),$(t).removeAttr("style"),$(e).removeAttr("class"),$(e).html("")}$("#tgl_awal,#tgl_akhir").datepicker({format:"mm/dd/yyyy",autoclose:!0,todayHighlight:!0}),$("#data").DataTable(),$(".nav-item").on("click",function(){$(".nav-item").removeClass("active")}),$("#supplier").on("focus",e),$("#qty").on("focus",e),$("#kd_barang").on("focus",e),$("#nama_barang").on("focus",e),$("#harga_beli").on("focus",s),$("#harga_jual").on("focus",s),$("#harga_jual").on("keyup",function(){var a=r($("#harga_jual").val());null!=a&&$(this).val(a)}),$("#harga_beli,#qty").on("keyup",function(){var a=Number($("#qty").val().trim()),t=r($("#harga_beli").val().replace(/[^\d]/g,""));if(null!=t){var e=$("#harga_beli").val(t)[0].value.replace(/[^\d]/g,""),s=a*Number(e);$("#total").val(r(s))}}),$("#tomboltambahdata").on("click",function(){$("#judul_modal").html("Tambah Data"),$("#loading").hide(),$("#tambahpembelian").show(),$("#form")[0].reset()}),$("#tambahpembelian").on("click",function(){var e=$("#supplier").val().trim(),s=$("#qty").val().trim(),l=$("#kd_barang").val().trim(),i=$("#nama_barang").val().trim(),n=$("#harga_beli").val().trim(),o=$("#harga_jual").val().trim(),c="";""===e?c="<i class='fas fa-exclamation-circle'></i> supplier wajib di isi":e.length>20&&(c="<i class='fas fa-exclamation-circle'></i> maximal 20 karakter"),t(c,"#supplier_Error","#supplier");var u="";""===s?u="<i class='fas fa-exclamation-circle'></i> qty wajib di isi":!1===/^\d{1,}$/.test(s)&&(u="<i class='fas fa-exclamation-circle'></i> hanya di isi angka"),t(u,"#qty_Error","#qty");var d="";""===l?d+="<i class='fas fa-exclamation-circle'></i> kode barang wajib di isi":l.length>8&&(d+="<i class='fas fa-exclamation-circle'></i> maximal 8 karakter"),t(d,"#kd_barangError","#kd_barang");var m="";""===i&&(m="<i class='fas fa-exclamation-circle'></i> nama barang wajib di isi"),t(m,"#nama_barangError","#nama_barang");var h="";""===n?h="<i class='fas fa-exclamation-circle'></i> harga beli wajib di isi":!1===/^[^A-Za-z]{1,}$/.test(n)&&(h="<i class='fas fa-exclamation-circle'></i> hanya di isi angka"),t(h,"#harga_beliError","#beli");var b="";if(""===o?b="<i class='fas fa-exclamation-circle'></i> harga jual wajib di isi":!1===/^[^A-Za-z]{1,}$/.test(o)&&(b="<i class='fas fa-exclamation-circle'></i> hanya di isi angka"),t(b,"#harga_jualError","#jual"),""===c&&""===u&&""===d&&""===m&&""===h&&""===b){var p=$("#form").serialize();$.ajax({url:"pembelian/tambah_data",method:"post",dataType:"json",data:p,beforeSend:function(){$("#loading").show()},success:function(t){if("berhasil"===t.status){$("#view").html("");var e=0,s="";s+='<table class="table table-bordered table-hover" id="data" style="width:100%;">',s+='<thead class="small">',s+="<tr>",s+='<th class="text-center">No</th>',s+='<th class="text-center">Kode</th>',s+='<th class="text-center">Supplier</th>',s+='<th class="text-center">Nama</th>',s+='<th class="text-center">Beli</th>',s+='<th class="text-center">Jual</th>',s+='<th class="text-center">Total</th>',s+='<th class="text-center">Qty</th>',s+='<th class="text-center">Pengunggah</th>',s+="</tr>",s+="</thead>",s+='<tbody class="small">',$.each(t.data,function(t,l){s+="<tr>",s+='<td class="text-center">'+ ++e+"</td>",s+="<td>"+l.kd_barang+"</td>",s+="<td>"+l.supplier+"</td>",s+="<td>"+l.nama_barang+"</td>",s+="<td>Rp "+l.harga_beli+"</td>",s+="<td>Rp "+l.harga_jual+"</td>",s+="<td>Rp "+r(l.total_harga)+"</td>",s+='<td class="text-center">'+l.qty+"</td>",s+='<td class="text-center">'+l.uploader+" | "+a(l.tanggal)+"</td > ",s+="</tr>"}),s+="</tbody>",s+="</table>",$("#loading").hide(),Swal.fire({title:"Berhasil",text:t.pesan,type:"success"}),$("#view").html(s),$("#data").DataTable(),$("#form")[0].reset(),$("#supplier")[0].style.border="",$("#qty")[0].style.border="",$("#kd_barang")[0].style.border="",$("#nama_barang")[0].style.border="",$("#harga_beli")[0].style.border="",$("#harga_jual")[0].style.border="",$("#beli")[0].style.border="",$("#jual")[0].style.border=""}}})}}),$("#tutup,#close").on("click",function(){function a(a){$(a)[0].nextElementSibling.className="",$(a)[0].nextElementSibling.innerHTML="",$(a)[0].style.border=""}$("#form")[0].reset(),a($("#supplier")),a($("#qty")),a($("#kd_barang")),a($("#nama_barang")),a($("#beli")),a($("#jual"))}),$("#qtyjual").on("keyup",function(){var a=Number($("#qtyjual").val().trim()),t=r($("#harga_jual").val().replace(/[^\d]/g,""));if(null!=t){var e=$("#harga_jual").val(t)[0].value.replace(/[^\d]/g,""),s=a*Number(e);$("#total").val(r(s))}}),$("#tutupjual,#closejual").on("click",function(){function a(a){$(a)[0].nextElementSibling.className="",$(a)[0].nextElementSibling.innerHTML="",$(a)[0].style.border=""}$("#formjual")[0].reset(),a($("#pembeli")),a($("#qtyjual")),a($("#nama_barang"))}),$("#tomboltambahdatajual").on("click",function(){$("#judul_modal").html("Tambah Data"),$("#loading").hide(),$("#tambah").show(),$("#formjual")[0].reset(),$("#nama_barang").html(""),$.ajax({url:"penjualan/namabarangall",method:"get",dataType:"json",success:function(a){var t="";t+='<option value="">-- Pilih Nama Barang --</option>',$.each(a,function(a,e){t+='<option value="'+e.nama_barang+'">'+e.nama_barang+"</option>"}),$("#nama_barang").append(t)}})}),$("#nama_barang").on("change",function(){var a=$("#nama_barang").val().trim();$.ajax({url:"penjualan/data_by_nama",data:{nama_barang:a},dataType:"json",method:"post",success:function(a){$("#kd_barangjual").val(a.kd_barang),$("#harga_jual").val(a.harga_jual)}})}),$("#tambahpenjualan").on("click",function(){var s=$("#qtyjual").val().trim(),l=$("#pembeli").val().trim(),i=$("#nama_barang").val().trim(),n="";""===l?n="<i class='fas fa-exclamation-circle'></i>  wajib di isi":l.length>20&&(n="<i class='fas fa-exclamation-circle'></i> maximal 20 karakter"),t(n,"#pembeli_Error","#pembeli"),$("#pembeli").on("focus",e);var o="";""===s?o="<i class='fas fa-exclamation-circle'></i> qty wajib di isi":!1===/^\d{1,}$/.test(s)&&(o="<i class='fas fa-exclamation-circle'></i> hanya di isi angka"),t(o,"#qty_Error","#qtyjual"),$("#qtyjual").on("focus",e);var c="";if(""===i&&(c="<i class='fas fa-exclamation-circle'></i> pilih nama barang"),t(c,"#nama_barangError","#nama_barang"),""===n&&""===c&&""===o){var u=$("#formjual").serialize();$.ajax({url:"penjualan/tambah_data",method:"post",data:u,dataType:"json",beforeSend:function(){$("#loading").show()},success:function(t){if("berhasil"===t.status){$("#loading").hide(),$("#view").html("");var e=0,s="";s+='<table class="table table-bordered table-hover" id="data" style="width:100%;">',s+='<thead class="small">',s+="<tr>",s+='<th class="text-center">No</th>',s+='<th class="text-center">Pembeli</th>',s+='<th class="text-center">Nama Barang</th>',s+='<th class="text-center">Jual</th>',s+='<th class="text-center">Total</th>',s+='<th class="text-center">Qty</td>',s+='<th class="text-center">Pengunggah</th>',s+='<th class="text-center"><i class="fas fa-print"></i></th>',s+="</tr>",s+="</thead>",s+='<tbody class="small">',$.each(t.data,function(t,l){s+="<tr>",s+='<td class="text-center">'+ ++e+"</td>",s+="<td>"+l.nama_pembeli+"</td>",s+="<td>"+l.nama_barang+"</td>",s+="<td>Rp "+l.harga_jual+"</td>",s+="<td>Rp "+r(l.total_harga)+"</td>",s+='<td class="text-center">'+l.qty+"</td>",s+='<td class="text-center">'+l.uploader+" | "+a(l.tanggal)+"</td>",s+='<td class="text-center">',s+='<a href="http://localhost/project/pos/penjualan/printpdf/'+l.no_trans+'">',s+='<button type = "button" class="btn btn-primary btn-sm">',s+='<i class="fas fa-download"></i>',s+="</button></a>",s+="</td>",s+="</tr>"}),s+="</tbody>",s+="</table>",Swal.fire({title:"Berhasil",text:t.pesan,type:"success"}),$("#view").html(s),$("#data").DataTable(),$("#formjual")[0].reset(),$("#qtyjual")[0].style.border="",$("#nama_barang")[0].style.border="",$("#pembeli")[0].style.border=""}}})}}),$("#tgl_awal").on("focus",s),$("#tgl_akhir").on("focus",s),$("#reset").on("click",function(){function a(a){$(a)[0].nextElementSibling.className="",$(a)[0].nextElementSibling.innerHTML="",$(a)[0].style.border=""}a("#tanggal_awal"),a("#tanggal_akhir")}),$("#form").on("submit",function(a){var t=$("#tgl_awal").val().trim(),e=$("#tgl_akhir").val().trim(),s="";""===t&&(s="<i class='fas fa-exclamation-circle'></i> tanggal awal wajib di isi"),""!==s?($("#tanggal_awalError").html(s),$("#tanggal_awalError").addClass("bg-danger text-white mt-1 p-1 font-weight-bold"),$("#tanggal_awalError").css("border-radius","6px"),$("#tanggal_awal").css("border","3px solid #e74a3b"),a.preventDefault()):($("#tanggal_awal").css("border","3px solid #1cc88a"),$("#tanggal_awalError").html(""),$("#tanggal_awalError").removeClass(),$("#tanggal_awalError").removeAttr("style"),$("#tanggal_awalError").removeAttr("class"));var r="";""===e&&(r="<i class='fas fa-exclamation-circle'></i> tanggal akhir wajib di isi"),""!==r?($("#tanggal_akhirError").html(r),$("#tanggal_akhirError").addClass("bg-danger text-white mt-1 p-1 font-weight-bold"),$("#tanggal_akhirError").css("border-radius","6px"),$("#tanggal_akhir").css("border","3px solid #e74a3b"),a.preventDefault()):($("#tanggal_akhir").css("border","3px solid #1cc88a"),$("#tanggal_akhirError").html(""),$("#tanggal_akhirError").removeClass(),$("#tanggal_akhirError").removeAttr("style"),$("#tanggal_akhirError").removeAttr("class"))}),$("#ubahnama").on("click",function(){var a="";if(""===$("#nama_baru").val().trim()&&(a="<i class='fas fa-exclamation-circle'></i> nama perusahaan baru wajib di isi"),t(a,"#nama_baruError","#nama"),$("#nama_baru").on("focus",s),""===a){$("#loading").removeAttr("style");var e=$("#formnama").serialize();$.ajax({url:"pengaturan_nama/ubah_nama",method:"post",dataType:"json",data:e,beforeSend:function(){$("#loading").show()},success:function(a){"berhasil"===a.status&&($("#loading").hide(),$("#nama_lama").val(a.data.nama_perusahaan),Swal.fire({title:"Berhasil",text:a.pesan,type:"success"}),$("#nama_baru").val(""),$("#nama").removeAttr("style"))}})}}),$("#resetnama").on("click",function(){l("#nama_baru","#nama","#nama_baruError")}),$("#ubahalamat").on("click",function(){var a="";if(""===$("#alamat_baru").val().trim()&&(a="<i class='fas fa-exclamation-circle'></i> alamat perusahaan baru wajib di isi"),t(a,"#alamat_baruError","#alamat"),$("#alamat_baru").on("focus",s),""===a){$("#loading").removeAttr("style");var e=$("#formalamat").serialize();$.ajax({url:"pengaturan_alamat/ubah_alamat",method:"post",dataType:"json",data:e,beforeSend:function(){$("#loading").show()},success:function(a){"berhasil"===a.status&&($("#loading").hide(),$("#alamat_lama").val(a.data.alamat_perusahaan),Swal.fire({title:"Berhasil",text:a.pesan,type:"success"}),$("#alamat_baru").val(""),$("#alamat").removeAttr("style"))}})}}),$("#resetnama").on("click",function(){l("#nama_baru","#nama","#nama_baruError")}),$("#resetalamat").on("click",function(){l("#alamat_baru","#alamat","#alamat_baruError")}),$("#tomboltambahuser").on("click",function(){$("#judul_modal").html("Tambah User"),$("#loading,#ubahdatauser").hide(),$("#tambah").show(),$("#formdatauser")[0].reset(),$("#pass,#ulang").show()}),$("#tambah").on("click",function(){var a=$("#nama_user").val().trim(),e=$("#email_user").val().trim(),s=$("#jabatan_user").val().trim(),r=$("#username").val().trim(),l=$("#password").val().trim(),i=$("#ulangpass").val().trim(),n=$("#tipe_user").val().trim(),o="";""===a&&(o="<i class='fas fa-exclamation-circle'></i> nama wajib di isi"),t(o,"#nama_userError","#nama_user");var c="";""===e?c="<i class='fas fa-exclamation-circle'></i> email wajib di isi":!1===/^\w{1,}[@]{1}\w{1,}\.\w{1,}$/.test(e)&&(c="<i class='fas fa-exclamation-circle'></i> format email salah"),t(c,"#email_userError","#email_user");var u="";""===s&&(u="<i class='fas fa-exclamation-circle'></i> jabatan wajib di isi"),t(u,"#jabatan_userError","#jabatan_user");var d="";""===r&&(d="<i class='fas fa-exclamation-circle'></i> username wajib di isi"),t(d,"#username_Error","#username");var m="";""===l?m="<i class='fas fa-exclamation-circle'></i> password wajib di isi":l.length<6&&(m="<i class='fas fa-exclamation-circle'></i> minimal 6 karakter"),t(m,"#pass_Error","#password");var h="";""===i?h="<i class='fas fa-exclamation-circle'></i> password wajib di isi":i!==l&&(h="<i class='fas fa-exclamation-circle'></i> password tidak sama"),t(h,"#ulangpassError","#ulangpass");var b="";if(""===n&&(b="<i class='fas fa-exclamation-circle'></i> tipe user wajib di pilih"),t(b,"#tipe_userError","#tipe_user"),""===o&&""===c&&""===u&&""===d&&""===m&&""===h&&""===b){var p=$("#formdatauser").serialize();$.ajax({url:"user/tambah_user",method:"post",data:p,dataType:"json",beforeSend:function(){$("#loading").show()},success:function(a){if("berhasil"===a.status){$("#loading").hide(),$("#view").html("");var t=0,e="";e+='<table class="table table-bordered table-hover" id="data" style="width:100%;">',e+='<thead class="small">',e+="<tr>",e+='<th class="text-center">No</th>',e+='<th class="text-center">Nama</th>',e+='<th class="text-center">Username</th>',e+='<th class="text-center">Email</th>',e+='<th class="text-center">Jabatan</th>',e+='<th class="text-center">Tipe User</th>',e+='<th class="text-center"><i class="fas fa-cogs"></i></th>',e+="</tr>",e+="</thead>",e+='<tbody class="small">',$.each(a.data,function(a,s){"1"===s.tipe_user?tipe="Admin":tipe="User",e+="<tr>",e+='<td class="text-center">'+ ++t+"</td>",e+="<td>"+s.nama_user+"</td>",e+="<td>"+s.username+"</td>",e+="<td>"+s.email_user+"</td>",e+="<td>"+s.jabatan_user+"</td>",e+='<td class="text-center">'+tipe+"</td>",e+='<td class="text-center">',e+='\n                                    <button id="ubahpass" title="ubah password" data-id="'+s.id_user+'" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#formpassword">\n                                           <i class="fas fa-unlock-alt"></i>\n                                     </button>\n                                     <button id="ubahuser" title="ubah user" data-id="'+s.id_user+'" class="btn btn-info btn-sm" data-toggle="modal" data-target="#formuser">\n                                           <i class="fas fa-user-cog"></i>\n                                     </button>\n                                     <button id="hapususer" title="hapus user" data-id="'+s.id_user+'" class="btn btn-danger btn-sm">\n                                           <i class="fas fa-user-alt-slash"></i>\n                                      </button>',e+="</td>",e+="</tr>"}),e+="</tbody>",e+="</table>",Swal.fire({title:"Berhasil",text:a.pesan,type:"success"})}$("#view").html(e),$("#data").DataTable(),$("#formdatauser")[0].reset(),$("#nama_user")[0].style.border="",$("#email_user")[0].style.border="",$("#jabatan_user")[0].style.border="",$("#username")[0].style.border="",$("#password")[0].style.border="",$("#ulangpass")[0].style.border="",$("#tipe_user")[0].style.border=""}})}}),$("#lihatpass").on("click",function(){"password"===$("#pass")[0].type?($("#pass")[0].type="text",$(this).html(""),$(this).html("<i class='fas fa-eye'></i>")):"text"===$("#pass")[0].type&&($("#pass")[0].type="password",$(this).html(""),$(this).html("<i class='fas fa-eye-slash'></i>"))}),$("#lihatulangpass").on("click",function(){"password"===$("#ulangpass")[0].type?($("#ulangpass")[0].type="text",$(this).html("<i class='fas fa-eye'></i>")):"text"===$("#ulangpass")[0].type&&($("#ulangpass")[0].type="password",$(this).html(""),$(this).html("<i class='fas fa-eye-slash'></i>"))}),$("#nama_user").on("focus",e),$("#email_user").on("focus",e),$("#jabatan_user").on("focus",e),$("#username").on("focus",e),$("#tipe_user").on("focus",e),$("#password").on("focus",function(){$("#pass_Error").removeAttr("class").html(""),$(this).removeAttr("style")}),$("#ulangpass").on("focus",function(){$("#ulangpassError").removeAttr("class").html(""),$(this).removeAttr("style")}),$("#tutupuser,#closeuser").on("click",function(){function a(a){$(a)[0].nextElementSibling.className="",$(a)[0].nextElementSibling.innerHTML="",$(a)[0].style.border=""}$("#formdatauser")[0].reset(),a("#nama_user"),a("#email_user"),a("#jabatan_user"),a("#username"),$("#password").removeAttr("style"),$("#ulangpass").removeAttr("style"),a("#tipe_user"),$("#pass_Error").html(""),$("#pass_Error").removeAttr("class"),$("#ulangpassError").html(""),$("#ulangpassError").removeAttr("class")}),$("#view").on("click","#ubahuser",function(){$("#judul_modal").html("Ubah Data"),$("#loading,#tambah,#pass,#ulang").hide(),$("#ubahdatauser").show();var a=$(this).data("id");$.ajax({url:"user/tampil_id",method:"post",data:{id:a},dataType:"json",success:function(a){$("#nama_user").val(a.nama_user),$("#email_user").val(a.email_user),$("#jabatan_user").val(a.jabatan_user),$("#username").val(a.username),$("#tipe_user").val(a.tipe_user),$("#id").val(a.id_user)}})}),$("#ubahdatauser").on("click",function(){var a=$("#nama_user").val().trim(),e=$("#email_user").val().trim(),s=$("#jabatan_user").val().trim(),r=$("#username").val().trim(),l=$("#tipe_user").val().trim(),i="";""===a&&(i="<i class='fas fa-exclamation-circle'></i> nama wajib di isi"),t(i,"#nama_userError","#nama_user");var n="";""===e?n="<i class='fas fa-exclamation-circle'></i> email wajib di isi":!1===/^\w{1,}[@]{1}\w{1,}\.\w{1,}$/.test(e)&&(n="<i class='fas fa-exclamation-circle'></i> format email salah"),t(n,"#email_userError","#email_user");var o="";""===s&&(o="<i class='fas fa-exclamation-circle'></i> jabatan wajib di isi"),t(o,"#jabatan_userError","#jabatan_user");var c="";""===r&&(c="<i class='fas fa-exclamation-circle'></i> username wajib di isi"),t(c,"#username_Error","#username");var u="";if(""===l&&(u="<i class='fas fa-exclamation-circle'></i> tipe user wajib di pilih"),t(u,"#tipe_userError","#tipe_user"),""===i&&""===n&&""===o&&""===c&&""===u){var d=$("#formdatauser").serialize();$.ajax({url:"user/ubah_user_id",method:"post",dataType:"json",data:d,beforeSend:function(){$("#loading").show()},success:function(a){if("berhasil"===a.status){$("#loading").hide(),$("#view").html("");var t=0,e="";e+='<table class="table table-bordered table-hover" id="data" style="width:100%;">',e+='<thead class="small">',e+="<tr>",e+='<th class="text-center">No</th>',e+='<th class="text-center">Nama</th>',e+='<th class="text-center">Username</th>',e+='<th class="text-center">Email</th>',e+='<th class="text-center">Jabatan</th>',e+='<th class="text-center">Tipe User</th>',e+='<th class="text-center"><i class="fas fa-cogs"></i></th>',e+="</tr>",e+="</thead>",e+='<tbody class="small">',$.each(a.data,function(a,s){"1"===s.tipe_user?tipe="Admin":tipe="User",e+="<tr>",e+='<td class="text-center">'+ ++t+"</td>",e+="<td>"+s.nama_user+"</td>",e+="<td>"+s.username+"</td>",e+="<td>"+s.email_user+"</td>",e+="<td>"+s.jabatan_user+"</td>",e+='<td class="text-center">'+tipe+"</td>",e+='<td class="text-center">',e+='\n                                    <button id="ubahpass" title="ubah password" data-id="'+s.id_user+'" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#formpassword">\n                                           <i class="fas fa-unlock-alt"></i>\n                                     </button>\n                                     <button id="ubahuser" title="ubah user" data-id="'+s.id_user+'" class="btn btn-info btn-sm" data-toggle="modal" data-target="#formuser">\n                                           <i class="fas fa-user-cog"></i>\n                                     </button>\n                                     <button id="hapususer" title="hapus user" data-id="'+s.id_user+'" class="btn btn-danger btn-sm">\n                                           <i class="fas fa-user-alt-slash"></i>\n                                      </button>',e+="</td>",e+="</tr>"}),e+="</tbody>",e+="</table>",Swal.fire({title:"Berhasil",text:a.pesan,type:"success"})}$("#view").html(e),$("#data").DataTable(),$("#nama_user")[0].style.border="",$("#email_user")[0].style.border="",$("#jabatan_user")[0].style.border="",$("#username")[0].style.border="",$("#tipe_user").removeAttr("style")}})}}),$("#view").on("click","#ubahpass",function(){$("#judul_modalpass").html("Ubah Password");var a=$(this).data("id");$("#loadingpass").hide(),$.ajax({url:"user/tampil_id",method:"post",data:{id:a},dataType:"json",success:function(a){$("#usernamelamafix").val(a.username),$("#idpass").val(a.id_user)}})}),$("#lihatpass").on("click",function(){"password"===$("#password")[0].type?($("#password")[0].type="text",$(this).html(""),$(this).html("<i class='fas fa-eye'></i>")):"text"===$("#password")[0].type&&($("#password")[0].type="password",$(this).html(""),$(this).html("<i class='fas fa-eye-slash'></i>"))}),$("#lihatpassbaru").on("click",function(){"password"===$("#passwordbaru")[0].type?($("#passwordbaru")[0].type="text",$(this).html(""),$(this).html("<i class='fas fa-eye'></i>")):"text"===$("#passwordbaru")[0].type&&($("#passwordbaru")[0].type="password",$(this).html(""),$(this).html("<i class='fas fa-eye-slash'></i>"))}),$("#lihatulangpassbaru").on("click",function(){"password"===$("#ulangpasswordbaru")[0].type?($("#ulangpasswordbaru")[0].type="text",$(this).html("<i class='fas fa-eye'></i>")):"text"===$("#ulangpasswordbaru")[0].type&&($("#ulangpasswordbaru")[0].type="password",$(this).html(""),$(this).html("<i class='fas fa-eye-slash'></i>"))}),$("#ubahpassword").on("click",function(){var a=$("#passwordbaru").val().trim(),e=$("#ulangpasswordbaru").val().trim(),s="";""===a?s="<i class='fas fa-exclamation-circle'></i> password wajib di isi":a.length<6&&(s="<i class='fas fa-exclamation-circle'></i> minimal 6 karakter"),t(s,"#pass_ErrorBaru","#passwordbaru");var r="";if(""===e?r="<i class='fas fa-exclamation-circle'></i> password wajib di isi":e!==a&&(r="<i class='fas fa-exclamation-circle'></i> password tidak sama"),t(r,"#ulangpass_ErrorBaru","#ulangpasswordbaru"),""===s&&""===r){var l=$("#idpass").val();$.ajax({url:"user/ubah_pass_id",method:"post",dataType:"json",data:{id:l,passwordbaru:a},beforeSend:function(){$("#loadingpass").show()},success:function(a){if("berhasil"===a.status){$("#loadingpass").hide(),$("#view").html("");var t=0,e="";e+='<table class="table table-bordered table-hover" id="data" style="width:100%;">',e+='<thead class="small">',e+="<tr>",e+='<th class="text-center">No</th>',e+='<th class="text-center">Nama</th>',e+='<th class="text-center">Username</th>',e+='<th class="text-center">Email</th>',e+='<th class="text-center">Jabatan</th>',e+='<th class="text-center">Tipe User</th>',e+='<th class="text-center"><i class="fas fa-cogs"></i></th>',e+="</tr>",e+="</thead>",e+='<tbody class="small">',$.each(a.data,function(a,s){"1"===s.tipe_user?tipe="Admin":tipe="User",e+="<tr>",e+='<td class="text-center">'+ ++t+"</td>",e+="<td>"+s.nama_user+"</td>",e+="<td>"+s.username+"</td>",e+="<td>"+s.email_user+"</td>",e+="<td>"+s.jabatan_user+"</td>",e+='<td class="text-center">'+tipe+"</td>",e+='<td class="text-center">',e+='\n                                    <button id="ubahpass" title="ubah password" data-id="'+s.id_user+'" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#formpassword">\n                                           <i class="fas fa-unlock-alt"></i>\n                                     </button>\n                                     <button id="ubahuser" title="ubah user" data-id="'+s.id_user+'" class="btn btn-info btn-sm" data-toggle="modal" data-target="#formuser">\n                                           <i class="fas fa-user-cog"></i>\n                                     </button>\n                                     <button id="hapususer" title="hapus user" data-id="'+s.id_user+'" class="btn btn-danger btn-sm">\n                                           <i class="fas fa-user-alt-slash"></i>\n                                      </button>',e+="</td>",e+="</tr>"}),e+="</tbody>",e+="</table>",Swal.fire({title:"Berhasil",text:a.pesan,type:"success"})}$("#passwordbaru").val(""),$("#ulangpasswordbaru").val(""),$("#view").html(e),$("#data").DataTable(),$("#passwordbaru").removeAttr("style"),$("#ulangpasswordbaru").removeAttr("style")}})}}),$("#passwordbaru").on("focus",function(){$("#pass_ErrorBaru").removeAttr("class").html(""),$(this).removeAttr("style")}),$("#ulangpasswordbaru").on("focus",function(){$("#ulangpass_ErrorBaru").removeAttr("class").html(""),$(this).removeAttr("style")}),$("#tutuppassword,#closepass").on("click",function(){$("#formpass")[0].reset(),$("#passwordbaru").removeAttr("style"),$("#ulangpasswordbaru").removeAttr("style"),$("#pass_ErrorBaru").html(""),$("#pass_ErrorBaru").removeAttr("class"),$("#ulangpass_ErrorBaru").html(""),$("#ulangpass_ErrorBaru").removeAttr("class")}),$("#view").on("click","#hapususer",function(){var a=$(this).data("id");Swal.fire({title:"Apakah anda yakin ?",text:"Data akan dihapus secara permanen!",type:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:'<i class="fas fa-user-alt-slash"></i> Hapus',cancelButtonText:"Tutup"}).then(t=>{t.value&&$.ajax({url:"user/hapus_user",method:"post",data:{id:a},dataType:"json",success:function(a){if("berhasil"===a.status){$("#loadingpass").hide(),$("#view").html("");var t=0,e="";e+='<table class="table table-bordered table-hover" id="data" style="width:100%;">',e+='<thead class="small">',e+="<tr>",e+='<th class="text-center">No</th>',e+='<th class="text-center">Nama</th>',e+='<th class="text-center">Username</th>',e+='<th class="text-center">Email</th>',e+='<th class="text-center">Jabatan</th>',e+='<th class="text-center">Tipe User</th>',e+='<th class="text-center"><i class="fas fa-cogs"></i></th>',e+="</tr>",e+="</thead>",e+='<tbody class="small">',$.each(a.data,function(a,s){"1"===s.tipe_user?tipe="Admin":tipe="User",e+="<tr>",e+='<td class="text-center">'+ ++t+"</td>",e+="<td>"+s.nama_user+"</td>",e+="<td>"+s.username+"</td>",e+="<td>"+s.email_user+"</td>",e+="<td>"+s.jabatan_user+"</td>",e+='<td class="text-center">'+tipe+"</td>",e+='<td class="text-center">',e+='\n                                        <button id="ubahpass" title="ubah password" data-id="'+s.id_user+'" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#formpassword">\n                                               <i class="fas fa-unlock-alt"></i>\n                                         </button>\n                                         <button id="ubahuser" title="ubah user" data-id="'+s.id_user+'" class="btn btn-info btn-sm" data-toggle="modal" data-target="#formuser">\n                                               <i class="fas fa-user-cog"></i>\n                                         </button>\n                                         <button id="hapususer" title="hapus user" data-id="'+s.id_user+'" class="btn btn-danger btn-sm">\n                                               <i class="fas fa-user-alt-slash"></i>\n                                          </button>',e+="</td>",e+="</tr>"}),e+="</tbody>",e+="</table>",Swal.fire({title:"Berhasil",text:a.pesan,type:"success"})}$("#view").html(e),$("#data").DataTable()}})})})});